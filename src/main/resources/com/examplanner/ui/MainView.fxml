<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.control.ProgressBar?>
<?import javafx.scene.control.TitledPane?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>

<BorderPane prefHeight="800.0" prefWidth="1200.0" stylesheets="@style.css" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.examplanner.ui.MainController">
   
   <!-- Sidebar -->
   <left>
      <VBox fx:id="sidebar" prefWidth="250.0" styleClass="sidebar" BorderPane.alignment="CENTER">
         <children>
            <HBox alignment="CENTER_LEFT" spacing="10">
               <Label styleClass="app-title" text="Exam Planner" />
            </HBox>
            
            <VBox spacing="5">
               <Button fx:id="btnDataImport" maxWidth="Infinity" mnemonicParsing="false" onAction="#showDataImport" styleClass="nav-button, active" text="Data Import" />
                <Button fx:id="btnDashboard" maxWidth="Infinity" mnemonicParsing="false" onAction="#showDashboard" styleClass="nav-button" text="Dashboard" />
               <Button fx:id="btnTimetable" maxWidth="Infinity" mnemonicParsing="false" onAction="#showTimetable" styleClass="nav-button" text="Timetable" />
               <Button fx:id="btnFilter" maxWidth="Infinity" mnemonicParsing="false" onAction="#handleFilter" styleClass="nav-button" text="Student Search" />
                <Button fx:id="btnUserManual" maxWidth="Infinity" mnemonicParsing="false" onAction="#showUserManual" styleClass="nav-button" text="üìñ User Manual" />
                <Separator />
                <Button fx:id="btnStudentPortal" maxWidth="Infinity" mnemonicParsing="false" onAction="#handleStudentPortal" styleClass="nav-button" text="Student Portal (Login)" />
            </VBox>
            
            <Region VBox.vgrow="ALWAYS" />
            
            <Button fx:id="btnSettings" maxWidth="Infinity" mnemonicParsing="false" onAction="#handleSettings" styleClass="nav-button" text="‚öôÔ∏è Settings" />
            <Button fx:id="btnExit" maxWidth="Infinity" mnemonicParsing="false" onAction="#handleExit" styleClass="nav-button" text="Exit" />
         </children>
      </VBox>
   </left>

   <!-- Main Content Area -->
   <center>
      <StackPane styleClass="content-area" BorderPane.alignment="CENTER">
         
         <!-- Data Import View -->
         <VBox fx:id="viewDataImport" spacing="20.0">
            <children>
               <VBox>
                  <Label fx:id="lblDataImportTitle" styleClass="section-title" text="Data Import" />
                  <Label fx:id="lblDataImportSubtitle" styleClass="section-subtitle" text="Import required data files to begin" />
               </VBox>

               <VBox spacing="15">
                  <!-- Courses Card -->
                  <HBox styleClass="card" onMouseClicked="#handleLoadCourses" alignment="CENTER_LEFT" spacing="15">
                     <Label text="üìÑ" style="-fx-font-size: 24px;"/>
                     <VBox>
                        <Label fx:id="lblCoursesTitle" styleClass="card-title" text="Courses" />
                        <Label fx:id="lblCoursesStatus" styleClass="card-subtitle" text="courses.csv ‚Ä¢ Not loaded" />
                     </VBox>
                  </HBox>

                  <!-- Students Card -->
                  <HBox styleClass="card" onMouseClicked="#handleLoadStudents" alignment="CENTER_LEFT" spacing="15">
                     <Label text="üéì" style="-fx-font-size: 24px;"/>
                     <VBox>
                        <Label fx:id="lblStudentsTitle" styleClass="card-title" text="Students" />
                        <Label fx:id="lblStudentsStatus" styleClass="card-subtitle" text="students.csv ‚Ä¢ Not loaded" />
                     </VBox>
                  </HBox>

                  <!-- Classrooms Card -->
                  <HBox styleClass="card" onMouseClicked="#handleLoadClassrooms" alignment="CENTER_LEFT" spacing="15">
                     <Label text="üè¢" style="-fx-font-size: 24px;"/>
                     <VBox>
                        <Label fx:id="lblClassroomsTitle" styleClass="card-title" text="Classrooms" />
                        <Label fx:id="lblClassroomsStatus" styleClass="card-subtitle" text="rooms.csv ‚Ä¢ Not loaded" />
                     </VBox>
                  </HBox>

                  <!-- Attendance Card -->
                  <HBox styleClass="card" onMouseClicked="#handleLoadAttendance" alignment="CENTER_LEFT" spacing="15">
                     <Label text="üë•" style="-fx-font-size: 24px;"/>
                     <VBox>
                        <Label fx:id="lblAttendanceTitle" styleClass="card-title" text="Attendance" />
                        <Label fx:id="lblAttendanceStatus" styleClass="card-subtitle" text="attendance.csv ‚Ä¢ Not loaded" />
                     </VBox>
                  </HBox>
               </VBox>

               <Region VBox.vgrow="ALWAYS" />

               <VBox fx:id="progressContainer" alignment="CENTER" spacing="8" visible="false" managed="false">
                  <Label fx:id="lblProgressStatus" text="Generating timetable..." style="-fx-font-size: 13px; -fx-text-fill: #6B7280;"/>
                  <ProgressBar fx:id="progressBar" maxWidth="Infinity" prefHeight="20"/>
               </VBox>

               <HBox spacing="10">
                  <Button fx:id="btnDeleteData" maxWidth="Infinity" HBox.hgrow="ALWAYS" mnemonicParsing="false" onAction="#handleDeleteData" styleClass="danger-button" text="Delete All Data" />
                  <Button fx:id="btnGenerateDataImport" maxWidth="Infinity" HBox.hgrow="ALWAYS" mnemonicParsing="false" onAction="#handleGenerateTimetable" styleClass="primary-button" text="Generate Timetable" />
               </HBox>
            </children>
            <padding>
               <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
            </padding>
         </VBox>

         <!-- Timetable View -->
         <VBox fx:id="viewTimetable" spacing="20.0" visible="false">
            <children>
               <HBox alignment="CENTER_LEFT" spacing="20">
                   <Button text="‚Üê Back" onAction="#showDataImport" styleClass="secondary-button" />
                  <VBox>
                     <Label styleClass="section-title" text="Exam Schedule" />
                     <Label styleClass="section-subtitle" text="December 2025 - Final Exams" />
                  </VBox>
                  <Region HBox.hgrow="ALWAYS" />
                  
                  <!-- Advanced Search Bar -->
                  <ComboBox fx:id="cmbSearchType" prefWidth="120" styleClass="secondary-button" />
                  <TextField fx:id="txtCourseSearch" promptText="Search..." prefWidth="150" styleClass="search-field" />
                  <Button fx:id="btnClearSearch" text="√ó" styleClass="secondary-button" style="-fx-min-width: 30;" onAction="#handleClearSearch" />
                  
                  <Button fx:id="btnHistory" mnemonicParsing="false" onAction="#showEditHistory" styleClass="secondary-button" text="üìú History" />
                  <Button fx:id="btnValidateAll" mnemonicParsing="false" onAction="#handleValidateAll" styleClass="secondary-button" text="‚úì Validate All" />
                  <Button fx:id="btnConflicts" mnemonicParsing="false" onAction="#handleConflicts" styleClass="secondary-button" text="Conflicts" />
                  <Button fx:id="btnExport" mnemonicParsing="false" onAction="#handleExport" styleClass="secondary-button" text="Export CSV" />
                  <Button fx:id="btnExportPdf" mnemonicParsing="false" onAction="#handleExportPdf" styleClass="secondary-button" text="Export PDF" />
                  <Button fx:id="btnGenerateTimetable" mnemonicParsing="false" onAction="#handleGenerateTimetable" styleClass="primary-button" text="Generate Timetable" />
               </HBox>
               
               <!-- Edit Help Text -->
               <HBox alignment="CENTER_LEFT" spacing="15" style="-fx-background-color: #F0FDF4; -fx-padding: 10 15; -fx-background-radius: 8; -fx-border-color: #86EFAC; -fx-border-radius: 8;">
                  <Label text="üí°" style="-fx-font-size: 16px; -fx-text-fill: #F59E0B;" />
                  <Label text="Tip: Double-click a row to edit, or right-click for quick actions. All changes are validated in real-time." style="-fx-text-fill: #166534; -fx-font-size: 12px;" />
               </HBox>

               <TableView fx:id="examTableView" styleClass="exam-table" VBox.vgrow="ALWAYS">
                  <columns>
                     <TableColumn fx:id="colExamId" text="Exam ID" minWidth="80" maxWidth="100" />
                     <TableColumn fx:id="colCourseCode" text="Course Code" minWidth="140" />
                     <TableColumn fx:id="colDay" text="Date" minWidth="80" maxWidth="100" />
                     <TableColumn fx:id="colTimeSlot" text="Time Slot" minWidth="100" maxWidth="130" />
                     <TableColumn fx:id="colClassroom" text="Classroom" minWidth="140" />
                     <TableColumn fx:id="colStudents" text="Students" minWidth="70" maxWidth="90" />
                     <TableColumn fx:id="colActions" text="Actions" minWidth="80" maxWidth="100" />
                  </columns>
               </TableView>
            </children>
            <padding>
               <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
            </padding>
         </VBox>

         <!-- Dashboard View -->
         <VBox fx:id="viewDashboard" spacing="20.0" visible="false">
             <padding>
                 <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
             </padding>
             <children>
                 <Label styleClass="section-title" text="Analytics Dashboard" />
                 <Label styleClass="section-subtitle" text="Schedule Insights" />
                 
                 <HBox spacing="20" VBox.vgrow="ALWAYS">
                     <VBox styleClass="card" HBox.hgrow="ALWAYS">
                         <Label styleClass="card-title" text="Exams Per Day" />
                         <BarChart fx:id="chartExamsPerDay">
                             <xAxis>
                                 <CategoryAxis label="Date" />
                             </xAxis>
                             <yAxis>
                                 <NumberAxis label="Count" />
                             </yAxis>
                         </BarChart>
                     </VBox>
                     
                     <VBox styleClass="card" HBox.hgrow="ALWAYS">
                         <Label styleClass="card-title" text="Room Utilization" />
                         <PieChart fx:id="chartRoomUsage" />
                     </VBox>
                 </HBox>
             </children>
         </VBox>
         <!-- user manuel View -->

<VBox fx:id="viewUserManual" spacing="20.0" visible="false">
              <padding>
                  <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
              </padding>
              <children>
                  <HBox alignment="CENTER_LEFT" spacing="20">
                      <Button text="‚Üê Back" onAction="#showDataImport" styleClass="secondary-button" />
                      <VBox>
                          <Label styleClass="section-title" text="üìñ User Manual" />
                          <Label styleClass="section-subtitle" text="Exam Planner Usage Guide" />
                      </VBox>
                  </HBox>
                  
                  <ScrollPane fitToWidth="true" style="-fx-background-color: transparent;" VBox.vgrow="ALWAYS">
                      <content>
                          <VBox spacing="10" styleClass="manual-container">
                              
                              <TitledPane styleClass="manual-section" expanded="true">
                                  <text>üöÄ 1. Getting Started</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          <Label wrapText="true" styleClass="manual-text" text="Exam Planner is a powerful tool designed to automatically generate university exam schedules." />
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üìã System Requirements:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ Java 21 or higher&#10;‚Ä¢ JavaFX 21&#10;‚Ä¢ Minimum 4GB RAM&#10;‚Ä¢ 100MB free disk space" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üéØ Core Workflow:" />
                                              <Label wrapText="true" styleClass="manual-text" text="1. Import CSV files (Courses, Students, Classrooms, Attendance)&#10;2. Click the 'Generate Timetable' button&#10;3. View and export the generated schedule" />
                                          </VBox>
                                          
                                          <HBox styleClass="manual-tip" spacing="10">
                                              <Label text="üí°" style="-fx-font-size: 18px; -fx-text-fill: #e8c710ff;" />
                                              <Label wrapText="true" styleClass="manual-tip-text" text="Tip: Review the sample CSV formats before uploading all your data files." />
                                          </HBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                              <TitledPane styleClass="manual-section">
                                  <text>üìÑ 2. Data Import</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          <Label wrapText="true" styleClass="manual-text" text="Four different CSV files are required to create an exam schedule. The system supports two different formats:" />
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üìö Courses.csv:" />
                                              <Label wrapText="true" styleClass="manual-code" text="Format 1 (Simple): CourseCode only&#10;Example: CourseCode_01&#10;&#10;Format 2 (Detailed): CourseCode,CourseName,DurationMinutes&#10;Example: CS101,Introduction to Programming,120" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ CourseCode: Unique course code (required)&#10;‚Ä¢ CourseName: Course name (optional, code used if blank)&#10;‚Ä¢ DurationMinutes: Exam duration in minutes (optional, default: 120)" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üéì Students.csv:" />
                                              <Label wrapText="true" styleClass="manual-code" text="Format 1 (Simple): StudentID only&#10;Example: Std_ID_001&#10;&#10;Format 2 (Detailed): StudentID,StudentName&#10;Example: 2021001,John Doe" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üè¢ Classrooms.csv:" />
                                              <Label wrapText="true" styleClass="manual-code" text="Format 1: RoomName;Capacity (semicolon separated)&#10;Example: Classroom_01;40&#10;&#10;Format 2: RoomID,RoomName,Capacity (comma separated)&#10;Example: R101,A Block 101,50" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üë• Attendance.csv (Registrations):" />
                                              <Label wrapText="true" styleClass="manual-code" text="Format 1 (Python List):&#10;CourseCode_01&#10;['Std_ID_001', 'Std_ID_002', ...]&#10;&#10;Format 2 (CSV): StudentID,CourseCode&#10;2021001,CS101" />
                                              <Label wrapText="true" styleClass="manual-text" text="Note: Specifies the registered students for each course." />
                                          </VBox>
                                          
                                          <HBox styleClass="manual-tip" spacing="10">
                                              <Label text="üí°" style="-fx-font-size: 18px; -fx-text-fill: #F59E0B;" />
                                              <Label wrapText="true" styleClass="manual-tip-text" text="Tip: Files may contain header rows like 'ALL OF THE...'; the system will automatically skip these." />
                                          </HBox>
                                          
                                          <HBox styleClass="manual-warning" spacing="10">
                                              <Label text="üõë" style="-fx-font-size: 18px; -fx-text-fill: #DC2626;" />
                                              <Label wrapText="true" styleClass="manual-warning-text" text="Warning: The system will warn you if you select the wrong file type. Ensure each file is uploaded to its correct button." />
                                          </HBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                              <TitledPane styleClass="manual-section">
                                  <text>üìÖ 3. Timetable Generation</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          <Label wrapText="true" styleClass="manual-text" text="The system uses an advanced algorithm to create a conflict-free exam schedule." />
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="‚öôÔ∏è Algorithm Features:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ Finding optimal number of days via Binary Search&#10;‚Ä¢ Student conflict checking&#10;‚Ä¢ Classroom capacity validation&#10;‚Ä¢ Minimum 3-hour gap constraint&#10;‚Ä¢ Maximum 2 exams per day constraint" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üîÑ Generation Steps:" />
                                              <Label wrapText="true" styleClass="manual-text" text="1. Click the 'Generate Timetable' button&#10;2. Select the start and end dates for the exam period&#10;3. Monitor the progress bar&#10;4. The program will automatically switch to the Timetable view" />
                                          </VBox>
                                          
                                          <HBox styleClass="manual-tip" spacing="10">
                                              <Label text="üí°" style="-fx-font-size: 18px; -fx-text-fill: #F59E0B;" />
                                              <Label wrapText="true" styleClass="manual-tip-text" text="Tip: For large datasets, the process may take a few minutes. Please wait patiently." />
                                          </HBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                              <TitledPane styleClass="manual-section">
                                  <text>‚úèÔ∏è 3.5. Manual Editing</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          <Label wrapText="true" styleClass="manual-text" text="You can manually edit the generated exam schedule. All changes are validated in real-time and saved to history." />
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üñ±Ô∏è Editing Methods:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ Double Click: Double-click any row to open the detailed edit screen&#10;‚Ä¢ Right-Click Menu: Right-click for quick changes&#10;‚Ä¢ Edit Button: Click the 'Edit' button at the end of the row" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="‚ö° Quick Change Options:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ Quick Change Date: Change only the date&#10;‚Ä¢ Quick Change Time: Change only the time&#10;‚Ä¢ Quick Change Classroom: Change only the classroom" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üìù Full Edit:" />
                                              <Label wrapText="true" styleClass="manual-text" text="In the window that opens when you click Edit:&#10;‚Ä¢ Use the date picker to set a new date&#10;‚Ä¢ Select a new time from the dropdown menu&#10;‚Ä¢ Choose a classroom with sufficient capacity&#10;‚Ä¢ View the registered student list (Click 'üë• Enrolled Students')" />
                                          </VBox>
                                          
                                          <HBox styleClass="manual-tip" spacing="10">
                                              <Label text="üí°" style="-fx-font-size: 18px; -fx-text-fill: #e8c710ff;" />
                                              <Label wrapText="true" styleClass="manual-tip-text" text="Tip: Every change is validated instantly and can be viewed via the 'üìú History' button. A green checkmark indicates a valid change, while a red warning indicates a conflict." />
                                          </HBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                              <TitledPane styleClass="manual-section">
                                  <text>‚úì 3.6. Validation and Constraint Checking</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          <Label wrapText="true" styleClass="manual-text" text="When manual changes are made, the system automatically checks all constraints." />
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üîç Checked Constraints:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ Classroom capacity: Number of students must not exceed capacity&#10;‚Ä¢ Classroom conflict: The same room cannot be used for another exam simultaneously&#10;‚Ä¢ Student conflict: A student cannot be in two exams at once&#10;‚Ä¢ Time range: Exams must be between 09:00-18:30&#10;‚Ä¢ Minimum gap: At least 3 hours between exams for students" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üìä Batch Validation:" />
                                              <Label wrapText="true" styleClass="manual-text" text="Click the 'Validate All' button to verify the entire schedule. This checks all exams and lists those with issues." />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üé® Visual Feedback:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ ‚úì Green: Change is valid, no constraint violations&#10;‚Ä¢ ‚ö† Red: Conflict detected, details will be shown&#10;‚Ä¢ Capacity Indicator: Shows the classroom occupancy rate" />
                                          </VBox>
                                          
                                          <HBox styleClass="manual-warning" spacing="10">
                                              <Label text="üõë" style="-fx-font-size: 18px; -fx-text-fill: #DC2626;" />
                                              <Label wrapText="true" styleClass="manual-warning-text" text="Important: You will receive a warning if you attempt to save changes with constraint violations. You will be asked if you still wish to proceed." />
                                          </HBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                              <TitledPane styleClass="manual-section">
                                  <text>üîç 4. Filtering and Search</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          <Label wrapText="true" styleClass="manual-text" text="You can easily search through the generated schedule." />
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üîç Advanced Search Bar:" />
                                              <Label wrapText="true" styleClass="manual-text" text="Filter by different criteria using the search bar on the Timetable screen:&#10;&#10;‚Ä¢ Course: Search by course code (e.g., CS101)&#10;‚Ä¢ Date: Search by date (formats: dd/MM/yyyy, dd.MM.yyyy, dd/MM, or dd.MM)&#10;‚Ä¢ Time: Search by time range (formats: HH:mm or HH:mm-HH:mm)&#10;‚Ä¢ Classroom: Search by classroom name&#10;&#10;Click the '√ó' button to clear the search." />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üë§ Filter by Student:" />
                                              <Label wrapText="true" styleClass="manual-text" text="1. Click the 'Student Search' button&#10;2. Select 'Filter by Student'&#10;3. Search for a student name or select from the list&#10;4. Only that student's exams will be displayed" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üìö Filter by Course:" />
                                              <Label wrapText="true" styleClass="manual-text" text="1. Click the 'Student Search' button&#10;2. Select 'Filter by Course'&#10;3. Search for the course code or name&#10;4. Relevant exam details will be displayed" />
                                          </VBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                              <TitledPane styleClass="manual-section">
                                  <text>üìú 4.5. Edit History</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          <Label wrapText="true" styleClass="manual-text" text="All edits are automatically recorded and can be viewed in the history." />
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üìã Viewing History:" />
                                              <Label wrapText="true" styleClass="manual-text" text="1. Click the 'üìú History' button on the Timetable screen&#10;2. All changes are listed in chronological order&#10;3. Each record shows:&#10; ¬† ‚Ä¢ Course code and name&#10; ¬† ‚Ä¢ Type of change (Date, Time, Classroom)&#10; ¬† ‚Ä¢ Old value (red)&#10; ¬† ‚Ä¢ New value (green)&#10; ¬† ‚Ä¢ Timestamp of change" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üóë Clearing History:" />
                                              <Label wrapText="true" styleClass="manual-text" text="Click 'Clear History' in the History window to delete all records." />
                                          </VBox>
                                          
                                          <HBox styleClass="manual-tip" spacing="10">
                                              <Label text="üí°" style="-fx-font-size: 18px; -fx-text-fill: #F59E0B;" />
                                              <Label wrapText="true" styleClass="manual-tip-text" text="Tip: Edit history is kept while the application is open. It is reset when the application is closed." />
                                          </HBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                              <TitledPane styleClass="manual-section">
                                  <text>üì§ 5. Export</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          <Label wrapText="true" styleClass="manual-text" text="You can export the generated exam schedule in different formats." />
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üìä Export to CSV:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ Click the 'Export CSV' button&#10;‚Ä¢ Choose the save location&#10;‚Ä¢ The file can be opened in Excel or other spreadsheet software" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üìë Export to PDF:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ Click the 'Export PDF' button&#10;‚Ä¢ A professionally formatted PDF will be created&#10;‚Ä¢ Ideal for printing and distribution" />
                                          </VBox>
                                          
                                          <HBox styleClass="manual-tip" spacing="10">
                                              <Label text="üí°" style="-fx-font-size: 18px; -fx-text-fill: #e8c710ff; " />
                                              <Label wrapText="true" styleClass="manual-tip-text" text="Tip: The PDF format should be preferred for official announcements." />
                                          </HBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                              <TitledPane styleClass="manual-section">
                                  <text>üìä 6. Dashboard Analytics</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          <Label wrapText="true" styleClass="manual-text" text="The Dashboard provides a visual analysis of the exam schedule. Charts are interactive‚Äîclick on them for detailed information." />
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üìà Exams Per Day Chart:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ Displays the number of exams per day as a bar chart&#10;‚Ä¢ Easily identify busy days&#10;‚Ä¢ üñ±Ô∏è Click a bar to list all exams for that day" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üéØ Room Utilization Chart:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ Displays room usage rates as a pie chart&#10;‚Ä¢ See which rooms are used most frequently&#10;‚Ä¢ üñ±Ô∏è Click a slice to list all exams in that room" />
                                          </VBox>
                                          
                                          <HBox styleClass="manual-tip" spacing="10">
                                              <Label text="üí°" style="-fx-font-size: 18px; -fx-text-fill: #e8c710ff; " />
                                              <Label wrapText="true" styleClass="manual-tip-text" text="Tip: A hand cursor appears when hovering over interactive chart elements." />
                                          </HBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                              <TitledPane styleClass="manual-section">
                                  <text>üéì 7. Student Portal</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          <Label wrapText="true" styleClass="manual-text" text="Students can view their own personal exam schedules." />
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üîê Logging In:" />
                                              <Label wrapText="true" styleClass="manual-text" text="1. Click the 'Student Portal' button&#10;2. Enter your student ID&#10;3. Your personal exam schedule will be displayed" />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="üìã Viewing:" />
                                              <Label wrapText="true" styleClass="manual-text" text="‚Ä¢ You will only see your own exams&#10;‚Ä¢ Date, time, and classroom information are listed&#10;‚Ä¢ Organized in chronological order" />
                                          </VBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                              <TitledPane styleClass="manual-section">
                                  <text>‚ùì 8. Frequently Asked Questions (FAQ)</text>
                                  <content>
                                      <VBox spacing="15" styleClass="manual-content">
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="Q: My CSV file won't upload, what should I do?" />
                                              <Label wrapText="true" styleClass="manual-text" text="A: Check the file format. Ensure you are using UTF-8 encoding and that the column separators are correct." />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="Q: Schedule generation is taking too long?" />
                                              <Label wrapText="true" styleClass="manual-text" text="A: For very large datasets (10,000+ students), the process can take 1-2 minutes. This is normal." />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="Q: I am getting a conflict warning, what does it mean?" />
                                              <Label wrapText="true" styleClass="manual-text" text="A: Some students have multiple exams in the same time slot. View details via the 'Conflicts' button." />
                                          </VBox>
                                          
                                          <VBox styleClass="manual-subsection">
                                              <Label styleClass="manual-subtitle" text="Q: How do I delete data?" />
                                              <Label wrapText="true" styleClass="manual-text" text="A: Use the 'Delete All Data' button on the Data Import page. This action cannot be undone!" />
                                          </VBox>
                                          
                                          <HBox styleClass="manual-warning" spacing="10">
                                              <Label text="üõë" style="-fx-font-size: 18px; -fx-text-fill: #DC2626;" />
                                              <Label wrapText="true" styleClass="manual-warning-text" text="Important: Data deletion is permanent. Ensure you have a backup before deleting." />
                                          </HBox>
                                      </VBox>
                                  </content>
                              </TitledPane>
                              
                          </VBox>
                      </content>
                  </ScrollPane>
              </children>
          </VBox>

      </StackPane>
   </center>
   
</BorderPane>
